# SPO-oriented profile template for spo.
# This file is not the canonical source of runtime defaults.
# Runtime defaults are defined in src/config.rs.
# Precedence at runtime:
#   built-in defaults < values in this file < explicit CLI flags
#
# Shared schema note:
# - canonical section name is `training_core`
# - parser also accepts legacy alias `ppo_core` for compatibility

environment:
  task_id: "BinPack-v0"
  num_envs: 64
  max_items: 20
  max_ems: 40
  max_episode_steps: 20

training_core:
  # Used by SPO trainer for rollout/update scheduling.
  rollout_length: 20
  num_updates: 2
  epochs: 1
  num_minibatches: 16
  gamma: 1.0

optimization:
  actor_lr: 0.0003
  critic_lr: 0.0003
  # Soft target-network update coefficient (used by SPO).
  tau: 0.005

architecture:
  hidden_dim: 16
  # Optional explicit adapter selection: "dense" | "binpack".
  # Set to null to use metadata auto-detection.
  observation_adapter: null
  seed: 42

evaluation:
  eval_interval: 1
  num_eval_envs: 64
  num_eval_episodes: 64

hardware:
  device_type: "cuda"
  cuda_device: 1

logging:
  # Base tracing level used when RUST_LOG is not set
  log_level: "info"
  # Keep CubeCL/CUDA backend context logs hidden by default
  backend_logs_visible: false
  # OTLP base endpoint (traces export uses /v1/traces).
  otlp_endpoint: "http://localhost:5000"
  # Optional existing MLflow run id; null triggers auto-create on lead rank.
  mlflow_run_id: null

spo:
  num_particles: 4
  search_depth: 4
  replay_buffer_size: 512
  sample_sequence_length: 8
  sample_period: 1
  dual_lr: 0.001
  epsilon: 0.5
  epsilon_policy: 0.001
  init_log_temperature: 3.0
  init_log_alpha: 3.0
  search_gamma: 1.0
  search_gae_lambda: 1.0
  root_exploration_dirichlet_alpha: 1.0
  root_exploration_dirichlet_fraction: 0.0
  resampling_period: 4
  resampling_ess_threshold: 0.5
  adaptive_temperature: true
  fixed_temperature: 0.5
